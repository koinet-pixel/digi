<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Digischool | Dashboard</title>

<style>
* {
    box-sizing: border-box;
    font-family: Arial, Helvetica, sans-serif;
}

body {
    margin: 0;
    background: #f4f6f8;
}

/* ===== HEADER ===== */
header {
    position: sticky;
    top: 0;
    z-index: 1000;
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 13px 17px;
    background: #0288d1;
    color: #fff;
}

.hamburger {
    font-size: 26px;
    cursor: pointer;
    display: none;
}

/* ===== LAYOUT ===== */
.page {
    display: flex;
}

/* ===== SIDEBAR ===== */
.sidebar {
    width: 220px;
    background: #1e3a8a;
    padding-top: 20px;
    position: fixed;
    top: 60px;
    bottom: 0;
}

.sidebar a,
.dropdown-btn {
    display: block;
    padding: 12px 20px;
    color: white;
    text-decoration: none;
    background: none;
    border: none;
    width: 100%;
    text-align: left;
    font-size: 15px;
    cursor: pointer;
}

.sidebar a:hover,
.dropdown-btn:hover {
    background: #1d4ed8;
}

.dropdown-content {
    display: none;
    background: #2563eb;
}

.dropdown-content a {
    padding-left: 40px;
    font-size: 14px;
}

.dropdown-content a:hover {
    background: #1e40af;
}

/* ===== MAIN ===== */
.main {
    margin-left: 220px;
    padding: 30px;
    width: 100%;
}

h2 {
    margin-bottom: 20px;
    color: #0288d1;
}

/* ===== DASHBOARD CARDS ===== */
.cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 20px;
}

.card {
    background: white;
    padding: 25px;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    text-align: center;
}

.card h3 {
    margin: 0;
    font-size: 16px;
    color: #555;
}

.card .count {
    font-size: 36px;
    margin-top: 10px;
    font-weight: bold;
    color: #0288d1;
}

.card.present .count {
    color: #2e7d32;
}

/* ===== MOBILE ===== */
@media (max-width: 768px) {
    .hamburger { display: block; }

    .sidebar {
        left: -100%;
        transition: 0.3s;
    }

    .sidebar.active {
        left: 0;
    }

    .main {
        margin-left: 0;
    }
}
</style>
</head>

<body>

<header>
    <span class="hamburger" onclick="toggleSidebar()">â˜°</span>
    <strong id="dashboardTitle">Digischool Dashboard</strong>

</header>

<div class="page">

<!-- SIDEBAR -->
<nav class="sidebar" id="sidebar">
    <a href="index.html">Dashboard</a>

    <div class="dropdown">
        <button class="dropdown-btn">Registry â–¾</button>
        <div class="dropdown-content">
            <a href="students.html">Students</a>
            <a href="teachers.html">Teachers</a>
        </div>
    </div>

    <div class="dropdown">
        <button class="dropdown-btn">Attendance â–¾</button>
        <div class="dropdown-content">
            <a href="attendance-students.html">Students</a>
            <a href="attendance-teachers.html">Teachers</a>
        </div>
    </div>

    <a href="#">Settings</a>
</nav>


<!-- MAIN -->
<div class="main">

<h2>Overview</h2>

<div class="cards">

    <div class="card">
        <h3>Teachers Registered</h3>
        <div class="count" id="teachersCount">0</div>
    </div>

    <div class="card">
        <h3>Students Registered</h3>
        <div class="count" id="studentsCount">0</div>
    </div>

    <div class="card present">
        <h3>Teachers Present Today</h3>
        <div class="count" id="teachersPresent">0</div>
    </div>

    <div class="card present">
        <h3>Students Present Today</h3>
        <div class="count" id="studentsPresent">0</div>
    </div>

</div>

</div>
</div>
<script type="module">

import { initializeApp } 
from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";

import { getAuth, onAuthStateChanged } 
from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";

import { 
    getFirestore, doc, getDoc,
    collection, query, where, getDocs
} 
from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";


const firebaseConfig = {
apiKey: "YOUR_KEY",
authDomain: "digischool-90ea0.firebaseapp.com",
projectId: "digischool-90ea0",
storageBucket: "digischool-90ea0.firebasestorage.app",
messagingSenderId: "63814149016",
appId: "1:63814149016:web:d1c508af4c210d2a36c1ed"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);


onAuthStateChanged(auth, async (user) => {

if (!user) {
    window.location.href = "login.html";
    return;
}

try {

const schoolId = user.uid;

// ðŸ”¹ Load school info
const schoolDoc = await getDoc(doc(db, "schools", schoolId));

if (schoolDoc.exists()) {

const data = schoolDoc.data();

document.getElementById("dashboardTitle")
.textContent = data.schoolName + " Dashboard";

document.getElementById("schoolNameSide")
.textContent = data.schoolName;

if (data.logoURL)
document.getElementById("schoolLogo").src = data.logoURL;

}


// ðŸ”¹ Count Teachers
const teachersQ = query(
collection(db, "teachers"),
where("schoolId", "==", schoolId)
);

const teachersSnap = await getDocs(teachersQ);
document.getElementById("teachersCount")
.textContent = teachersSnap.size;


// ðŸ”¹ Count Students
const studentsQ = query(
collection(db, "students"),
where("schoolId", "==", schoolId)
);

const studentsSnap = await getDocs(studentsQ);
document.getElementById("studentsCount")
.textContent = studentsSnap.size;

}
catch(e){
console.log("Dashboard error:", e);
}

});

import { addDoc, collection } from "firebase/firestore";

await addDoc(collection(db, "teachers"), {
schoolId: auth.currentUser.uid,
name: teacherName,
phone: teacherPhone,
createdAt: new Date()
});

</script>

</body>
</html>
