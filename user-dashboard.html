<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Digischool | Dashboard</title>

<style>
* {
    box-sizing: border-box;
    font-family: Arial, Helvetica, sans-serif;
}

body {
    margin: 0;
    background: #f4f6f8;
}

/* ===== HEADER ===== */
header {
    position: sticky;
    top: 0;
    z-index: 1000;
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 13px 17px;
    background: #0288d1;
    color: #fff;
}

.hamburger {
    font-size: 26px;
    cursor: pointer;
    display: none;
}

/* ===== LAYOUT ===== */
.page {
    display: flex;
}

/* ===== SIDEBAR ===== */
.sidebar {
    width: 220px;
    background: #1e3a8a;
    padding-top: 20px;
    position: fixed;
    top: 60px;
    bottom: 0;
}

.sidebar a,
.dropdown-btn {
    display: block;
    padding: 12px 20px;
    color: white;
    text-decoration: none;
    background: none;
    border: none;
    width: 100%;
    text-align: left;
    font-size: 15px;
    cursor: pointer;
}

.sidebar a:hover,
.dropdown-btn:hover {
    background: #1d4ed8;
}

.dropdown-content {
    display: none;
    background: #2563eb;
}

.dropdown-content a {
    padding-left: 40px;
    font-size: 14px;
}

.dropdown-content a:hover {
    background: #1e40af;
}

/* ===== MAIN ===== */
.main {
    margin-left: 220px;
    padding: 30px;
    width: 100%;
}

h2 {
    margin-bottom: 20px;
    color: #0288d1;
}

/* ===== DASHBOARD CARDS ===== */
.cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 20px;
}

.card {
    background: white;
    padding: 25px;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    text-align: center;
}

.card h3 {
    margin: 0;
    font-size: 16px;
    color: #555;
}

.card .count {
    font-size: 36px;
    margin-top: 10px;
    font-weight: bold;
    color: #0288d1;
}

.card.present .count {
    color: #2e7d32;
}

/* ===== MOBILE ===== */
@media (max-width: 768px) {
    .hamburger { display: block; }

    .sidebar {
        left: -100%;
        transition: 0.3s;
    }

    .sidebar.active {
        left: 0;
    }

    .main {
        margin-left: 0;
    }
}
</style>
</head>

<body>

<header>
    <span class="hamburger" onclick="toggleSidebar()">☰</span>
    <strong id="dashboardTitle">Digischool Dashboard</strong>

</header>

<div class="page">

<!-- SIDEBAR -->
<nav class="sidebar" id="sidebar">
    <strong id="dashboardTitle">Digischool Dashboard</strong>

<img id="schoolLogo">
<div id="schoolNameSide"></div>

    <div class="dropdown">
        <button class="dropdown-btn">Registry ▾</button>
        <div class="dropdown-content">
            <a href="register-students.html">Students</a>
            <a href="register-teachers.html">Teachers</a>
        </div>
    </div>

    <div class="dropdown">
        <button class="dropdown-btn">Attendance ▾</button>
        <div class="dropdown-content">
            <a href="attendance-students.html">Students</a>
            <a href="attendance-teachers.html">Teachers</a>
        </div>
    </div>

    <a href="#">Settings</a>
</nav>

<!-- MAIN -->
<div class="main">

<h2>Overview</h2>

<div class="cards">

    <div class="card">
        <h3>Teachers Registered</h3>
        <div class="count" id="teachersCount">0</div>
    </div>

    <div class="card">
        <h3>Students Registered</h3>
        <div class="count" id="studentsCount">0</div>
    </div>

    <div class="card present">
        <h3>Teachers Present Today</h3>
        <div class="count" id="teachersPresent">0</div>
    </div>

    <div class="card present">
        <h3>Students Present Today</h3>
        <div class="count" id="studentsPresent">0</div>
    </div>

</div>

</div>
</div>
<script type="module">

import { initializeApp } 
from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";

import { getAuth, onAuthStateChanged } 
from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";

import { getFirestore, doc, getDoc } 
from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const firebaseConfig = {
apiKey: "AIzaSyB8HwfE9-ObuCZbaWQ1Z2L8F3kL_Sv8EVY",
authDomain: "digischool-90ea0.firebaseapp.com",
projectId: "digischool-90ea0",
storageBucket: "digischool-90ea0.firebasestorage.app",
messagingSenderId: "63814149016",
appId: "1:63814149016:web:d1c508af4c210d2a36c1ed"
};


// Initialize
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);


// ✅ Check logged-in user
onAuthStateChanged(auth, async (user) => {

if (!user) {
    window.location.href = "login.html";
    return;
}

try {

const docRef = doc(db, "schools", user.uid);
const snap = await getDoc(docRef);

if (snap.exists()) {

const data = snap.data();

// Change title
document.getElementById("dashboardTitle")
.textContent = data.schoolName + " Dashboard";

// Sidebar name
if(document.getElementById("schoolNameSide"))
document.getElementById("schoolNameSide").textContent = data.schoolName;

// Logo
if(data.logoURL && document.getElementById("schoolLogo"))
document.getElementById("schoolLogo").src = data.logoURL;

}

} catch (error) {
console.log("Firestore error:", error);
}

});
</script>

</body>
</html>
